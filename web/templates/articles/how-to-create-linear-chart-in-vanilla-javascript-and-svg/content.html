<p><b class="highlight">Линейная диаграмма</b> – это один из самых наглядных и популярных способов отобразить изменение числовых значений с течением времени. Её часто используют для визуализации трендов, показателей роста, температуры, курса валют и любых других данных, где важна последовательность и динамика.</p>

<p>В этой статье вы узнаете, как с нуля реализовать линейную диаграмму на чистом JavaScript и SVG. Как и в <a class="link" href="/articles/how-to-create-bar-chart-in-vanilla-javascript-and-svg">прошлый раз</a>, вся реализация будет выполнена внутри единственного класса <code>LinearChart</code>, без сторонних библиотек, только нативный код и простая логика.</p>

<h2>Что у нас получится в итоге</h2>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M7.5 305L7.5 133.11881188118812L11.428571428571429 133.21109516764975L15.357142857142858 133.52778852939568L19.285714285714285 134.1314924900395L23.214285714285715 135.0837870296291L27.142857142857142 136.43748279898327L31.071428571428573 138.22780684124353L35 140.46449573435964L38.92857142857143 143.12714230960736L42.857142857142854 146.1655461006189L46.785714285714285 149.50527294863713L50.714285714285715 153.05679244559755L54.642857142857146 156.7253617973526L58.57142857142857 160.4188118536953L62.5 164.05138836204313L66.42857142857143 167.54314382997958L70.35714285714286 170.81544134857938L74.28571428571429 173.7836904372982L78.21428571428571 176.3486401278634L82.14285714285714 178.38774414968665L86.07142857142857 179.74861152637322L90 180.24752475247524L92.85714285714286 179.95103668058198L95.71428571428571 179.00734090551404L98.57142857142857 177.34149627121693L101.42857142857143 174.89571161164582L104.28571428571429 171.64157157741596L107.14285714285714 167.59236206870298L110 162.81273625474049L112.85714285714286 157.42256486025417L115.71428571428572 151.5924833401362L118.57142857142857 145.53052884736644L121.42857142857143 139.46183945243214L124.28571428571428 133.60559866695854L127.14285714285714 128.15420054550972L130 123.25862814912055L132.85714285714286 119.02183949833571L135.71428571428572 115.49960403088909L138.57142857142856 112.70662898303836L141.42857142857144 110.62528635898093L144.28571428571428 109.21459231723539L147.14285714285714 108.41786584414821L150 108.16831683168317L152.85714285714286 108.3924734552377L155.71428571428572 109.01180310974843L158.57142857142858 109.94314519934089L161.42857142857142 111.09870999801029L164.28571428571428 112.38643255922325L167.14285714285714 113.71139405193054L170 114.97880301741924L172.85714285714286 116.09864931737485L175.71428571428572 116.99164703674134L178.57142857142858 117.59559543177377L181.42857142857142 117.87099041920266L184.28571428571428 117.80476524321182L187.14285714285714 117.411453129624L190 116.7317059416742L192.85714285714286 115.8287245178289L195.71428571428572 114.7835333555604L198.57142857142856 113.69006749783063L201.42857142857144 112.6507846697823L204.28571428571428 111.77311195704156L207.14285714285714 111.16663060223823L210 110.94059405940592L212.85714285714286 111.20120667141308L215.71428571428572 112.04807197602412L218.57142857142858 113.56934993909913L221.42857142857142 115.83544210956492L224.28571428571428 118.89144568893397L227.14285714285714 122.74914121235543L230 127.37980200799699L232.85714285714286 132.70946677251928L235.71428571428572 138.6183000959413L238.57142857142858 144.94514145619667L241.42857142857142 151.49734253244677L244.28571428571428 158.0647704623792L247.14285714285714 164.43582223940288L250 170.41283918040318L252.85714285714286 175.82459516497747L255.71428571428572 180.53441923234126L258.57142857142856 184.44364522212675L261.42857142857144 187.49107186523798L264.2857142857143 189.64971550185635L267.14285714285717 190.92228858732287L270 191.33663366336634L272.85714285714283 190.94193722282165L275.7142857142857 189.80607892935723L278.57142857142856 188.01403067552323L281.42857142857144 185.66685777983193L284.2857142857143 182.88062402262045L287.14285714285717 179.78439831387922L290 176.5166447419203L292.85714285714283 173.21957818138446L295.7142857142857 170.03156566080236L298.57142857142856 167.0782519833681L301.42857142857144 164.46361289576248L304.2857142857143 162.26239388434465L307.14285714285717 160.5152492895202L310 159.22737291578525L312.85714285714283 158.37068020403763L315.7142857142857 157.8889138917545L318.57142857142856 157.70461168254386L321.42857142857144 157.7267827360142L324.2857142857143 157.85834033776558L327.14285714285717 158.00269764891317L330 158.06930693069307L332.85714285714283 157.97820438412006L335.7142857142857 157.6637626637648L338.57142857142856 157.07784803449192L341.42857142857144 156.19245646557872L344.2857142857143 155.00170923875672L347.14285714285717 153.52288530050484L350 151.79602811232905L352.85714285714283 149.88166412164927L355.7142857142857 147.85636032989936L358.57142857142856 145.8062258860995L361.42857142857144 143.81894379417128L364.2857142857143 141.97535132903266L367.14285714285717 140.34180530450223L370 138.96446966563698L372.85714285714283 137.86626854497158L375.7142857142857 137.04669509824615L378.57142857142856 136.484141952893L381.42857142857144 136.14007287854776L384.2857142857143 135.9642450130887L387.14285714285717 135.90028088245214L390 135.89108910891088L392.85714285714283 135.88384461838567L395.7142857142857 135.8343914382858L398.57142857142856 135.7109893285718L401.42857142857144 135.4972903001406L404.2857142857143 135.19433207603086L407.14285714285717 134.82122474946624L410 134.41415091228092L412.85714285714283 134.02336453298372L415.7142857142857 133.7081000210976L418.57142857142856 133.5296743624604L421.42857142857144 133.54349313374786L424.2857142857143 133.79101093573504L427.14285714285717 134.29280493674642L430 135.04372836745756L432.85714285714283 136.01067073874802L435.7142857142857 137.1329178270452L438.57142857142856 138.32466124533838L441.42857142857144 139.47898494709463L444.2857142857143 140.47268517541548L447.14285714285717 141.17150156762952L450 141.43564356435644L452.85714285714283 141.12577867096053L455.7142857142857 140.10982077275744L458.57142857142856 138.27085826833132L461.42857142857144 135.516358573243L464.2857142857143 131.78837191209723L467.14285714285717 127.07387517673239L470 121.41376189461978L472.85714285714283 114.9084996530226L475.7142857142857 107.7183991804744L478.57142857142856 100.05698593424617L481.42857142857144 92.17717113436704L484.2857142857143 84.35153437993701L487.14285714285717 76.84954531642079L490 69.91539841262771L492.85714285714283 63.74996678626972L495.7142857142857 58.499264658704035L498.57142857142856 54.250185666205475L501.42857142857144 51.03273717195731L504.2857142857143 48.82696462460139L507.14285714285717 47.57241475288944L510 47.17821782178214L512.8571428571429 47.53243664058325L515.7142857142857 48.50998906104608L518.5714285714286 49.979028962792185L521.4285714285714 51.806080373227026L524.2857142857143 53.86043253154193L527.1428571428571 56.0183217629052L530 58.16726335552785L532.8571428571429 60.21058520683086L535.7142857142857 62.07182261755712L538.5714285714286 63.698276257388386L541.4285714285714 65.06285963579437L544.2857142857143 66.16348732430178L547.1428571428571 67.01969528229046L550 67.66680932671466L552.8571428571429 68.14855339873826L555.7142857142857 68.509294600885L558.5714285714286 68.78706403235475L561.4285714285714 69.00814347279693L564.2857142857143 69.18354610780257L567.1428571428571 69.30732614452188L570 69.35643564356434L572.8571428571429 69.29182441138983L575.7142857142857 69.0606021657049L578.5714285714286 68.59927383966236L581.4285714285714 67.83823485610442L584.2857142857143 66.70778949584782L587.1428571428571 65.14584966313642L590 63.10711720856591L592.8571428571429 60.5729422595352L595.7142857142857 57.560296355680784L598.5714285714286 54.12768396786872L601.4285714285714 50.375742709461846L604.2857142857143 46.44108450851045L607.1428571428571 42.48358796586964L610 38.66933135177587L612.8571428571429 35.152786461475515L615.7142857142857 32.06207209737212L618.5714285714286 29.48992039559819L621.4285714285714 27.49113847028855L624.2857142857143 26.085606350726984L627.1428571428571 25.264841622409854L630 25L633.9285714285714 25.466216660504195L637.8571428571429 26.780161581511198L641.7857142857143 28.816494863870613L645.7142857142857 31.459521976116783L649.6428571428571 34.60582148818114L653.5714285714286 38.16146922589543L657.5 42.03634650305975L661.4285714285714 46.13759227609798L665.3571428571429 50.36405551668713L669.2857142857143 54.60352919261186L673.2142857142857 58.73429421211376L677.1428571428571 62.63172620642737L681.0714285714286 66.17929717029618L685 69.28158864938563L688.9285714285714 71.87573603466166L692.8571428571429 73.9378600764504L696.7857142857143 75.48266683279434L700.7142857142857 76.55674796777382L704.6428571428571 77.22799920822796L708.5714285714286 77.57420689943201L712.5 77.67326732673266L712.5 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M7.5 133.11881188118812L11.428571428571429 133.21109516764975L15.357142857142858 133.52778852939568L19.285714285714285 134.1314924900395L23.214285714285715 135.0837870296291L27.142857142857142 136.43748279898327L31.071428571428573 138.22780684124353L35 140.46449573435964L38.92857142857143 143.12714230960736L42.857142857142854 146.1655461006189L46.785714285714285 149.50527294863713L50.714285714285715 153.05679244559755L54.642857142857146 156.7253617973526L58.57142857142857 160.4188118536953L62.5 164.05138836204313L66.42857142857143 167.54314382997958L70.35714285714286 170.81544134857938L74.28571428571429 173.7836904372982L78.21428571428571 176.3486401278634L82.14285714285714 178.38774414968665L86.07142857142857 179.74861152637322L90 180.24752475247524L92.85714285714286 179.95103668058198L95.71428571428571 179.00734090551404L98.57142857142857 177.34149627121693L101.42857142857143 174.89571161164582L104.28571428571429 171.64157157741596L107.14285714285714 167.59236206870298L110 162.81273625474049L112.85714285714286 157.42256486025417L115.71428571428572 151.5924833401362L118.57142857142857 145.53052884736644L121.42857142857143 139.46183945243214L124.28571428571428 133.60559866695854L127.14285714285714 128.15420054550972L130 123.25862814912055L132.85714285714286 119.02183949833571L135.71428571428572 115.49960403088909L138.57142857142856 112.70662898303836L141.42857142857144 110.62528635898093L144.28571428571428 109.21459231723539L147.14285714285714 108.41786584414821L150 108.16831683168317L152.85714285714286 108.3924734552377L155.71428571428572 109.01180310974843L158.57142857142858 109.94314519934089L161.42857142857142 111.09870999801029L164.28571428571428 112.38643255922325L167.14285714285714 113.71139405193054L170 114.97880301741924L172.85714285714286 116.09864931737485L175.71428571428572 116.99164703674134L178.57142857142858 117.59559543177377L181.42857142857142 117.87099041920266L184.28571428571428 117.80476524321182L187.14285714285714 117.411453129624L190 116.7317059416742L192.85714285714286 115.8287245178289L195.71428571428572 114.7835333555604L198.57142857142856 113.69006749783063L201.42857142857144 112.6507846697823L204.28571428571428 111.77311195704156L207.14285714285714 111.16663060223823L210 110.94059405940592L212.85714285714286 111.20120667141308L215.71428571428572 112.04807197602412L218.57142857142858 113.56934993909913L221.42857142857142 115.83544210956492L224.28571428571428 118.89144568893397L227.14285714285714 122.74914121235543L230 127.37980200799699L232.85714285714286 132.70946677251928L235.71428571428572 138.6183000959413L238.57142857142858 144.94514145619667L241.42857142857142 151.49734253244677L244.28571428571428 158.0647704623792L247.14285714285714 164.43582223940288L250 170.41283918040318L252.85714285714286 175.82459516497747L255.71428571428572 180.53441923234126L258.57142857142856 184.44364522212675L261.42857142857144 187.49107186523798L264.2857142857143 189.64971550185635L267.14285714285717 190.92228858732287L270 191.33663366336634L272.85714285714283 190.94193722282165L275.7142857142857 189.80607892935723L278.57142857142856 188.01403067552323L281.42857142857144 185.66685777983193L284.2857142857143 182.88062402262045L287.14285714285717 179.78439831387922L290 176.5166447419203L292.85714285714283 173.21957818138446L295.7142857142857 170.03156566080236L298.57142857142856 167.0782519833681L301.42857142857144 164.46361289576248L304.2857142857143 162.26239388434465L307.14285714285717 160.5152492895202L310 159.22737291578525L312.85714285714283 158.37068020403763L315.7142857142857 157.8889138917545L318.57142857142856 157.70461168254386L321.42857142857144 157.7267827360142L324.2857142857143 157.85834033776558L327.14285714285717 158.00269764891317L330 158.06930693069307L332.85714285714283 157.97820438412006L335.7142857142857 157.6637626637648L338.57142857142856 157.07784803449192L341.42857142857144 156.19245646557872L344.2857142857143 155.00170923875672L347.14285714285717 153.52288530050484L350 151.79602811232905L352.85714285714283 149.88166412164927L355.7142857142857 147.85636032989936L358.57142857142856 145.8062258860995L361.42857142857144 143.81894379417128L364.2857142857143 141.97535132903266L367.14285714285717 140.34180530450223L370 138.96446966563698L372.85714285714283 137.86626854497158L375.7142857142857 137.04669509824615L378.57142857142856 136.484141952893L381.42857142857144 136.14007287854776L384.2857142857143 135.9642450130887L387.14285714285717 135.90028088245214L390 135.89108910891088L392.85714285714283 135.88384461838567L395.7142857142857 135.8343914382858L398.57142857142856 135.7109893285718L401.42857142857144 135.4972903001406L404.2857142857143 135.19433207603086L407.14285714285717 134.82122474946624L410 134.41415091228092L412.85714285714283 134.02336453298372L415.7142857142857 133.7081000210976L418.57142857142856 133.5296743624604L421.42857142857144 133.54349313374786L424.2857142857143 133.79101093573504L427.14285714285717 134.29280493674642L430 135.04372836745756L432.85714285714283 136.01067073874802L435.7142857142857 137.1329178270452L438.57142857142856 138.32466124533838L441.42857142857144 139.47898494709463L444.2857142857143 140.47268517541548L447.14285714285717 141.17150156762952L450 141.43564356435644L452.85714285714283 141.12577867096053L455.7142857142857 140.10982077275744L458.57142857142856 138.27085826833132L461.42857142857144 135.516358573243L464.2857142857143 131.78837191209723L467.14285714285717 127.07387517673239L470 121.41376189461978L472.85714285714283 114.9084996530226L475.7142857142857 107.7183991804744L478.57142857142856 100.05698593424617L481.42857142857144 92.17717113436704L484.2857142857143 84.35153437993701L487.14285714285717 76.84954531642079L490 69.91539841262771L492.85714285714283 63.74996678626972L495.7142857142857 58.499264658704035L498.57142857142856 54.250185666205475L501.42857142857144 51.03273717195731L504.2857142857143 48.82696462460139L507.14285714285717 47.57241475288944L510 47.17821782178214L512.8571428571429 47.53243664058325L515.7142857142857 48.50998906104608L518.5714285714286 49.979028962792185L521.4285714285714 51.806080373227026L524.2857142857143 53.86043253154193L527.1428571428571 56.0183217629052L530 58.16726335552785L532.8571428571429 60.21058520683086L535.7142857142857 62.07182261755712L538.5714285714286 63.698276257388386L541.4285714285714 65.06285963579437L544.2857142857143 66.16348732430178L547.1428571428571 67.01969528229046L550 67.66680932671466L552.8571428571429 68.14855339873826L555.7142857142857 68.509294600885L558.5714285714286 68.78706403235475L561.4285714285714 69.00814347279693L564.2857142857143 69.18354610780257L567.1428571428571 69.30732614452188L570 69.35643564356434L572.8571428571429 69.29182441138983L575.7142857142857 69.0606021657049L578.5714285714286 68.59927383966236L581.4285714285714 67.83823485610442L584.2857142857143 66.70778949584782L587.1428571428571 65.14584966313642L590 63.10711720856591L592.8571428571429 60.5729422595352L595.7142857142857 57.560296355680784L598.5714285714286 54.12768396786872L601.4285714285714 50.375742709461846L604.2857142857143 46.44108450851045L607.1428571428571 42.48358796586964L610 38.66933135177587L612.8571428571429 35.152786461475515L615.7142857142857 32.06207209737212L618.5714285714286 29.48992039559819L621.4285714285714 27.49113847028855L624.2857142857143 26.085606350726984L627.1428571428571 25.264841622409854L630 25L633.9285714285714 25.466216660504195L637.8571428571429 26.780161581511198L641.7857142857143 28.816494863870613L645.7142857142857 31.459521976116783L649.6428571428571 34.60582148818114L653.5714285714286 38.16146922589543L657.5 42.03634650305975L661.4285714285714 46.13759227609798L665.3571428571429 50.36405551668713L669.2857142857143 54.60352919261186L673.2142857142857 58.73429421211376L677.1428571428571 62.63172620642737L681.0714285714286 66.17929717029618L685 69.28158864938563L688.9285714285714 71.87573603466166L692.8571428571429 73.9378600764504L696.7857142857143 75.48266683279434L700.7142857142857 76.55674796777382L704.6428571428571 77.22799920822796L708.5714285714286 77.57420689943201L712.5 77.67326732673266"></path><text x="7.5" y="127.11881188118812" dominant-baseline="text-after-edge" text-anchor="start" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="7.5" cy="133.11881188118812" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="90" y="174.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="90" cy="180.24752475247524" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="150" y="102.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="150" cy="108.16831683168317" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="210" y="104.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="210" cy="110.94059405940592" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="270" y="185.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="270" cy="191.33663366336634" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="330" y="152.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="330" cy="158.06930693069307" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="390" y="129.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="390" cy="135.89108910891088" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="450" y="135.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="450" cy="141.43564356435644" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="510" y="41.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="510" cy="47.17821782178214" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="570" y="63.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="570" cy="69.35643564356434" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="630" y="19" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="630" cy="25" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="712.5" y="71.67326732673266" dominant-baseline="text-after-edge" text-anchor="end" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="712.5" cy="77.67326732673266" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle></svg>
</div>

<p>Вот пример, как будет выглядеть использование нашего класса:</p>

<div class="code">
    <div class="code-title">Пример использования класса LinearChart</div>
<pre data-lang="js">
const config = {
    svg: document.getElementById("linear-chart"),
    padding: {bottom: 25, top: 25},
    line: {
        color: "#fe7a81", // цвет линии
        background: "#ffddd7" // цвет области
    },
    marker: {
        radius: 5,
        color: "#fe7a81", // цвет контура маркера
        background: "#ffffff", // цвет заливки маркера
        width: 60, // ширина для одного значения
        height: 280 // максимальная высота для значения 
    },
    value: {size: 11, color: "#fe7a81"}, // параметры подписи значения
    label: {size: 10, color: "#888"} // параметры подписи метки
}

const data = [
    {value: 6.2, label: "январь\n2024"},
    {value: 4.5, label: "февраль\n2024"},
    {value: 7.1, label: "март\n2024"},
    {value: 7, label: "апрель\n2024"},
    {value: 4.1, label: "май\n2024"},
    {value: 5.3, label: "июнь\n2024"},
    {value: 6.1, label: "июль\n2024"},
    {value: 5.9, label: "август\n2024"},
    {value: 9.3, label: "сентябрь\n2024"},
    {value: 8.5, label: "октябрь\n2024"},
    {value: 10.1, label: "ноябрь\n2024"},
    {value: 8.2, label: "декабрь\n2024"}
]

const linearChart = new LinearChart(config)
linearChart.plot(data)
</pre>
</div>

<p>Теперь давайте создадим всё это по шагам – от заготовки HTML и JS до красивой и понятной линейной диаграммы.</p>

<h2>Шаг 0. Подготовка</h2>

<p>Начнём с создания двух файлов: <code>linear_chart.html</code> и <code>linear_chart.js</code>. В первом будет наша HTML-разметка и SVG-элемент, во втором – сам класс <code>LinearChart</code>, который мы будем постепенно наполнять.</p>

<p>Вот базовая заготовка <code>linear_chart.html</code>:</p>

<div class="code">
    <div class="code-title">Файл linear_chart.html</div>
<pre data-lang="html">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;title&gt;Линейная диаграмма&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;svg id="linear-chart"&gt;&lt;/svg&gt;

    &lt;script src="linear_chart.js"&gt;&lt;/script&gt;
    &lt;script&gt;
        // создание и управление диаграммой
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<p>Теперь создадим файл <code>linear_chart.js</code> и опишем каркас класса:</p>

<div class="code">
    <div class="code-title">Файл linear_chart.js</div>
<pre data-lang="js">
constructor(config) {
    this.svg = config.svg
    this.padding = {
        top: config.padding?.top ?? 15,
        bottom: config.padding?.bottom ?? 25
    }

    this.line = {
        color: config.line?.color ?? "#9cc2ff",
        background: config.line?.background ?? "#ecf4ff"
    }

    this.marker = {
        radius: config.marker?.radius ?? 5,
        color: config.marker?.color ?? "#9cc2ff",
        background: config.marker?.background ?? "#ffffff",
        width: config.marker?.width ?? 50,
        height: config.marker?.height ?? 300
    }

    this.value = {
        size: config.value.size ?? 10,
        color: config.value.color ?? "#888"
    }

    this.label = {
        size: config.label.size ?? 10,
        color: config.label.color ?? "#888"
    }
}
</pre>
</div>

<p>Пока всё просто – мы подготовили класс и сохранили в нём нужные параметры из конфига.</p>

<h2>Шаг 1. Определяемся с размерами</h2>

<p>Давайте посчитаем, какого размера должен быть наш <code>svg</code> элемент:</p>

<ul>
    <li>высота складывается из величин оступов (<code>padding.top</code> и <code>padding.bottom</code>), а также высоты маркера;</li>
    <li>для вычисления ширины достаточно просто умножить количество элементов в <code>data</code> на ширину маркера.</li>
</ul>

<p>Вычислим размеры и зададим их нашей диаграмме в методе <code>plot</code>:</p>

<div class="code">
    <div class="code-title">Задаём размеры диаграммы</div>
<pre data-lang="js">
plot(data) {
    const width = data.length * this.marker.width
    const height = this.padding.top + this.marker.height + this.padding.bottom

    this.svg.style.width = `${width}px`
    this.svg.style.height = `${height}px`
}
</pre>
</div>

<p>Также для отрисовки нам нужно знать, в каких диапазонах изменяются отрисовываемые значения и если в них нет перехода через 0, то нам нужно явно его добавить:</p>

<div class="code">
    <div class="code-title">Вычисляем диапазон изменения значений</div>
<pre data-lang="js">
const values = data.map(item => item.value)
const min = Math.min(...values, 0)
const max = Math.max(...values, 0)
</pre>
</div>

<h2>Шаг 2. Вычисление координат</h2>

<p>Чтобы отрисовать диаграмму, нужно правильно перевести значения данных в координаты на SVG. Для этого реализуем вспомогательную функцию <code>map</code>, которая позволяет "перемасштабировать" значение из одного диапазона в другой. Она понадобится нам практически на каждом этапе:</p>

<div class="code">
    <div class="code-title">Файл linear_chart.js</div>
<pre data-lang="js">
map(x, xmin, xmax, min, max) {
    return (x - xmin) * (max - min) / (xmax - xmin) + min
}
</pre>
</div>

<p>Теперь, чтобы узнать, в какой координате должна быть точка со значением <code>value</code> достаточно просто вызвать функцию <code>map</code>:</p>

<div class="code">
    <div class="code-title">Вычисление координаты <code>y</code> для некоторого значения <code>value</code></div>
<pre data-lang="js">
const y = map(value, min, max, height - this.padding.bottom, this.padding.top)
</pre>
</div>

<p class="note">Обратите внимание, в каком порядке мы передали <code>height - this.padding.bottom</code> и <code>this.padding.top</code> в качестве диапазона изменений координаты. Это связано с тем, что в <code>svg</code> координатная вертикальная ось направлена вниз, а не вверх, а потому большие значения <code>value</code> должны иметь меньшую координату на <code>svg</code>.</p>

<h2>Рисуем линии</h2>

<p>Чтобы построить кривую – будь то ломаная или сглаженная – в SVG используется элемент <code>&lt;path&gt;</code>. Помимо привычных атрибутов <code>fill</code>, <code>stroke</code> и <code>stroke-width</code>, с которыми вы уже сталкивались в  <a class="link" href="https://dronperminov.ru/articles/how-to-create-donut-chart-in-vanilla-javascript-and-svg">статье про пончиковую диаграмму</a>, у него есть особый атрибут <code>d</code>, содержащий <a class="link" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorials/SVG_from_scratch/Paths">команды</a> для рисования.

<p>Нас интересуют две команды:</p>

<ul>
    <li><code>M x y</code> – перемещает "перо" (курсор) в точку с координатами <code>(x, y)</code> без рисования;</li>
    <li><code>L x y</code> – рисует прямую линию от текущей позиции к точке <code>(x, y)</code> и перемещает перо в неё.</li>
</ul>

<p>В рамках нашей диаграммы мы сначала переместим перо в первую точку (<code>M</code>), а затем последовательно нарисуем линии ко всем остальным (<code>L</code>). Таким образом, получится основная линия графика.</p>

<p>Кроме неё, мы также хотим визуализировать закрашенную область под графиком – от первой до последней точки, с "замыканием" к нулевому уровню по оси <code>Y</code>. Эту зону мы будем отображать как отдельный путь, которому зададим заливку.</p>

<p>Чтобы всё это реализовать, добавим в класс метод <code>addPaths</code>, который создаст и добавит в SVG две кривые: одну для основной линии (<code>line</code>), другую – для закрашенной области (<code>area</code>). Вызовем этот метод внутри <code>plot</code>.</p>

<div class="code">
    <div class="code-title">Добавляем элементы для отрисовки линий</div>
<pre data-lang="js">
plot(data) {
    ...

    const paths = this.addPaths()
}

addPaths() {
    // добавляем path для закрашенной области
    const area = document.createElementNS("http://www.w3.org/2000/svg", "path")
    area.setAttribute("fill", this.line.background)
    this.svg.appendChild(area)

    // добавляем path для основной линии
    const line = document.createElementNS("http://www.w3.org/2000/svg", "path")
    line.setAttribute("fill", "none")
    line.setAttribute("stroke", this.line.color)
    line.setAttribute("stroke-width", this.marker.radius / 2)
    this.svg.appendChild(line)

    return {area, line}
}
</pre>
</div>

<p>Прежде чем мы сможем построить линии, нам необходимо вычислить координаты всех точек. Для этого создадим массив <code>points</code>, в который будем сохранять положения каждой точки на диаграмме. Этот массив позже будет использоваться как для отрисовки линии, так и для закрашенной области.</p>

<div class="code">
    <div class="code-title">Формируем массив с координатами точек</div>
<pre data-lang="js">
plot(data) {
    ...

    const paths = this.addPaths()
    const points = []

    for (let i = 0; i < data.length; i++) {
        const x = this.map(i, 0, data.length - 1, this.marker.width / 2, width - this.marker.width / 2)
        const y = this.map(data[i].value, min, max, height - this.padding.bottom, this.padding.top)

        points.push({x: x, y: y})
    }
}
</pre>
</div>

<p>Когда массив координат готов, мы можем перейти к построению кривых – для этого нужно задать атрибут <code>d</code> у созданных ранее элементов <code>path</code>. Вынесем эту логику в отдельный метод <code>updatePaths</code>:</p>

<div class="code">
    <div class="code-title">Отрисовываем линии</div>
<pre data-lang="js">
plot(data) {
    ...

    this.updatePaths(paths, points, min, max, height)
}

updatePaths(paths, points, min, max, height) {
    const y0 = this.map(0, min, max, height - this.padding.bottom, this.padding.top) // вычисляем координату нулевого значения

    paths.line.setAttribute("d", this.points2path(points))
    paths.area.setAttribute("d", this.points2path([{x: points[0].x, y: y0}, ...points, {x: points[points.length - 1].x, y: y0}]))
}
</pre>
</div>

<p>Если теперь запустить пример, приведённый в начале статьи, мы увидим нечто, уже напоминающее линейную диаграмму:</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M30 305L30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266L690 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266"></path></svg>
</div>

<p>Однако пока она выглядит довольно пусто – без подписей она малоинформативна.</p>

<h2>Добавляем подписи</h2>

<p>Пора сделать визуализацию более выразительной. Как и в случае со <a class="link" href="https://dronperminov.ru/articles/how-to-create-bar-chart-in-vanilla-javascript-and-svg">столбчатой диаграммой</a>, мы создадим универсальный метод <code>addLabel</code>, позволяющий добавлять текст с заданным выравниванием. Он также поддерживает многострочные надписи, если текст содержит символы перевода строки.</p>

<div class="code">
    <div class="code-title">Метод добавления произвольной подписи</div>
<pre data-lang="js">
addLabel(x, y, text, format, anchor, baseline) {
    for (const line of text.split("\n")) {
        const label = document.createElementNS("http://www.w3.org/2000/svg", "text")

        label.textContent = line
        label.setAttribute("x", x)
        label.setAttribute("y", y)
        label.setAttribute("dominant-baseline", baseline)
        label.setAttribute("text-anchor", anchor)
        label.setAttribute("fill", format.color)
        label.setAttribute("font-size", format.size)

        this.svg.appendChild(label)

        y += label.getBBox().height
    }
}
</pre>
</div>

<p>Теперь, внутри цикла, где вычисляются координаты точек, добавим подписи к меткам и значениям:</p>

<div class="code">
    <div class="code-title">Добавляем подписи</div>
<pre data-lang="js">
for (let i = 0; i < data.length; i++) {
    const x = this.map(i, 0, data.length - 1, this.marker.width / 2, width - this.marker.width / 2)
    const y = this.map(data[i].value, min, max, height - this.padding.bottom, this.padding.top)

    this.addLabel(x, y - 1, `${data[i].value}`, this.value, "middle", "text-after-edge")
    this.addLabel(x, height - this.padding.bottom, data[i].label, this.label, "middle", "text-before-edge")

    points.push({x: x, y: y})
}
</pre>
</div>

<p>На этом этапе диаграмма уже выглядит значительно лучше – появились осмысленные подписи. Но всё ещё есть пространство для улучшений.</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M30 305L30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266L690 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266"></path><text x="30" y="132.11881188118812" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="90" y="179.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="150" y="107.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="210" y="109.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="270" y="190.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="330" y="157.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="390" y="134.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="450" y="140.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="510" y="46.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="570" y="68.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="630" y="24" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><text x="690" y="76.67326732673266" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text></svg>
</div>

<h2>Добавляем маркеры</h2>

<p>Чтобы сделать диаграмму визуально выразительнее, добавим маркеры – небольшие окружности в точках данных. Для этого создадим метод <code>addMarker</code> и вызовем его внутри уже знакомого нам цикла, где вычисляются координаты точек:</p>

<div class="code">
    <div class="code-title">Добавляем маркеры</div>
<pre data-lang="js">
plot() {
    ...

    for (let i = 0; i < data.length; i++) {
        ...
        this.addLabel(x, y - this.marker.radius - 1, `${data[i].value}`, this.value, "middle", "text-after-edge")
        this.addLabel(x, height - this.padding.bottom, data[i].label, this.label, "middle", "text-before-edge")
        this.addMarker(x, y)
    }
    ...
}

addMarker(x, y) {
    const marker = document.createElementNS("http://www.w3.org/2000/svg", "circle")
    marker.setAttribute("cx", x)
    marker.setAttribute("cy", y)
    marker.setAttribute("r", this.marker.radius)
    marker.setAttribute("fill", this.marker.background)
    marker.setAttribute("stroke", this.marker.color)
    marker.setAttribute("stroke-width", this.marker.radius / 2)

    this.svg.appendChild(marker)
}
</pre>
</div>

<p>После этой небольшой доработки диаграмма выглядит значительно лучше:</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M30 305L30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266L690 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M30 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L690 77.67326732673266"></path><text x="30" y="127.11881188118812" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="30" cy="133.11881188118812" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="90" y="174.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="90" cy="180.24752475247524" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="150" y="102.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="150" cy="108.16831683168317" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="210" y="104.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="210" cy="110.94059405940592" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="270" y="185.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="270" cy="191.33663366336634" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="330" y="152.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="330" cy="158.06930693069307" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="390" y="129.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="390" cy="135.89108910891088" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="450" y="135.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="450" cy="141.43564356435644" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="510" y="41.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="510" cy="47.17821782178214" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="570" y="63.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="570" cy="69.35643564356434" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="630" y="19" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="630" cy="25" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="690" y="71.67326732673266" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="690" cy="77.67326732673266" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle></svg>
</div>

<p>Но всё же остаётся ощущение, что чего-то не хватает. Интуитивно хочется, чтобы первая точка начиналась у самой левой границы, а последняя – касалась правой. Исправим это.</p>

<h2>Сдвигаем первую и последнюю точки к краям</h2>

<p>Введём переменную <code>offset</code>, которая будет равна нулю для всех точек, кроме первой и последней. Первую точку сдвинем немного влево, последнюю – вправо. При этом учтём не только половину ширины маркера, но и его радиус с обводкой, чтобы добиться аккуратного выравнивания.</p>

<div class="code">
    <div class="code-title">Сдвигаем границы точек</div>
<pre data-lang="js">
const offset = (this.marker.width / 2 - this.marker.radius * 1.5) * (i == 0 ? -1 : i == data.length - 1 ? 1 : 0)

this.addLabel(x + offset, y - this.marker.radius - 1, `${data[i].value}`, this.value, "middle", "text-after-edge")
this.addLabel(x, height - this.padding.bottom, data[i].label, this.label, "middle", "text-before-edge")
this.addMarker(x + offset, y)
</pre>
</div>

<p>Теперь диаграмма выглядит ещё естественнее:</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M7.5 305L7.5 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L712.5 77.67326732673266L712.5 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M7.5 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L712.5 77.67326732673266"></path><text x="7.5" y="127.11881188118812" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="7.5" cy="133.11881188118812" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="90" y="174.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="90" cy="180.24752475247524" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="150" y="102.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="150" cy="108.16831683168317" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="210" y="104.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="210" cy="110.94059405940592" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="270" y="185.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="270" cy="191.33663366336634" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="330" y="152.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="330" cy="158.06930693069307" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="390" y="129.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="390" cy="135.89108910891088" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="450" y="135.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="450" cy="141.43564356435644" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="510" y="41.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="510" cy="47.17821782178214" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="570" y="63.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="570" cy="69.35643564356434" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="630" y="19" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="630" cy="25" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="712.5" y="71.67326732673266" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="712.5" cy="77.67326732673266" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle></svg>
</div>

<p>Казалось бы, всё готово – но есть один нюанс: если текст у первого или последнего значения окажется шире маркера, он может выйти за пределы диаграммы и обрезаться. Чтобы этого избежать, изменим выравнивание подписей: первая будет выровнена по левому краю, последняя – по правому. Все остальные останутся выровненными по центру:</p>

<div class="code">
    <div class="code-title">Выравниваем подписи значений</div>
<pre data-lang="js">
const offset = (this.marker.width / 2 - this.marker.radius * 1.5) * (i == 0 ? -1 : i == data.length - 1 ? 1 : 0)
const anchor = i == 0 ? "start" : i == data.length - 1 ? "end" : "middle"

this.addLabel(x + offset, y - this.marker.radius - 1, `${data[i].value}`, this.value, anchor, "text-after-edge")
</pre>
</div>

<p>Визуально диаграмма почти не изменилась, но теперь мы можем быть уверены, что любые значения будут отображаться корректно, независимо от их длины:</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M7.5 305L7.5 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L712.5 77.67326732673266L712.5 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M7.5 133.11881188118812L90 180.24752475247524L150 108.16831683168317L210 110.94059405940592L270 191.33663366336634L330 158.06930693069307L390 135.89108910891088L450 141.43564356435644L510 47.17821782178214L570 69.35643564356434L630 25L712.5 77.67326732673266"></path><text x="7.5" y="127.11881188118812" dominant-baseline="text-after-edge" text-anchor="start" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="7.5" cy="133.11881188118812" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="90" y="174.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="90" cy="180.24752475247524" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="150" y="102.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="150" cy="108.16831683168317" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="210" y="104.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="210" cy="110.94059405940592" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="270" y="185.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="270" cy="191.33663366336634" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="330" y="152.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="330" cy="158.06930693069307" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="390" y="129.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="390" cy="135.89108910891088" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="450" y="135.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="450" cy="141.43564356435644" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="510" y="41.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="510" cy="47.17821782178214" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="570" y="63.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="570" cy="69.35643564356434" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="630" y="19" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="630" cy="25" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="712.5" y="71.67326732673266" dominant-baseline="text-after-edge" text-anchor="end" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="712.5" cy="77.67326732673266" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle></svg>
</div>

<p>На этом можно было бы завершить, но есть ещё один штрих: линия графика выглядит слишком ломаной. Давайте сделаем её плавнее, добавив сглаживание!</p>

<h2>Сглаживаем прямые</h2>

<p>В красивых диаграммах редко встречаются резкие переходы на кривых, поэтому мы тоже не останемся в стороне и добавим сглаживание. Для этого между реальными значениями добавим промежуточные точки с помощью интерполяции.</p>

<p>Мы будем использовать метод обратных взвешенных расстояний. Он работает довольно просто: для каждой точки <code>x</code>, в которой нужно найти значение, метод учитывает все известные точки и вычисляет вклад каждой из них. Этот вклад обратно пропорционален расстоянию: чем ближе точка, тем сильнее она влияет на итоговый результат.</p>

<p>Мы используем взвешенное среднее значений <code>y</code>, где веса пропорциональны обратному квадрату расстояния от нужной точки до каждой известной. Если точка совпадает с одной из известных, мы просто берём её значение:</p>

<div class="code">
    <div class="code-title">Интерполяция методом обратных взвешенных расстояний</div>
<pre data-lang="js">
interpolate(x, points) {
    let result = 0
    let sum = 0

    for (let i = 0; i < points.length; i++) {
        const distance = Math.abs(x - points[i].x)

        if (distance === 0)
            return {x: x, y: points[i].y}

        const weight = 1 / Math.pow(distance, 2)
        result += points[i].y * weight
        sum += weight
    }

    return {x: x, y: result / sum}
}
</pre>
</div>

<p>Теперь дополним массив координат новыми точками с помощью метода <code>smoothPoints</code>:</p>

<div class="code">
    <div class="code-title">Получение сглаженных точек</div>
<pre data-lang="js">
smoothPoints(points, smoothCount = 20) {
    const smoothedPoints = [points[0]]

    for (let i = 1; i < points.length; i++) {
        for (let j = 0; j < smoothCount; j++)
            smoothedPoints.push(this.interpolate(this.map(j, -1, smoothCount, points[i - 1].x, points[i].x), points))

        smoothedPoints.push(points[i])
    }

    return smoothedPoints
}
</pre>
</div>

<p class="note">В качестве входного диапазона для функции <code>map</code> мы передаём значения <code>[-1, smoothCount]</code>, так как добавлять новые точки мы хотим только внутри диапазона <code>[0, smoothCount - 1]</code>.</p>

<p>После этого остаётся только вызвать метод сглаживания внутри <code>updatePaths</code>, чтобы добавить новые точки в диаграмму:</p>

<div class="code">
    <div class="code-title">Сглаживаем точки</div>
<pre data-lang="js">
updatePaths(paths, points, min, max, height) {
    const y0 = this.map(0, min, max, height - this.padding.bottom, this.padding.top)
    const smoothedPoints = this.smoothPoints(points)

    paths.line.setAttribute("d", this.points2path(smoothedPoints))
    paths.area.setAttribute("d", this.points2path([{x: points[0].x, y: y0}, ...smoothedPoints, {x: points[points.length - 1].x, y: y0}]))
}
</pre>
</div>

<p>И вот теперь наша диаграмма выглядит именно так, как и должна:</p>

<div class="article-center">
    <svg id="linear-chart" style="width: 720px; height: 330px;"><path fill="#ffddd7" d="M7.5 305L7.5 133.11881188118812L11.428571428571429 133.21109516764975L15.357142857142858 133.52778852939568L19.285714285714285 134.1314924900395L23.214285714285715 135.0837870296291L27.142857142857142 136.43748279898327L31.071428571428573 138.22780684124353L35 140.46449573435964L38.92857142857143 143.12714230960736L42.857142857142854 146.1655461006189L46.785714285714285 149.50527294863713L50.714285714285715 153.05679244559755L54.642857142857146 156.7253617973526L58.57142857142857 160.4188118536953L62.5 164.05138836204313L66.42857142857143 167.54314382997958L70.35714285714286 170.81544134857938L74.28571428571429 173.7836904372982L78.21428571428571 176.3486401278634L82.14285714285714 178.38774414968665L86.07142857142857 179.74861152637322L90 180.24752475247524L92.85714285714286 179.95103668058198L95.71428571428571 179.00734090551404L98.57142857142857 177.34149627121693L101.42857142857143 174.89571161164582L104.28571428571429 171.64157157741596L107.14285714285714 167.59236206870298L110 162.81273625474049L112.85714285714286 157.42256486025417L115.71428571428572 151.5924833401362L118.57142857142857 145.53052884736644L121.42857142857143 139.46183945243214L124.28571428571428 133.60559866695854L127.14285714285714 128.15420054550972L130 123.25862814912055L132.85714285714286 119.02183949833571L135.71428571428572 115.49960403088909L138.57142857142856 112.70662898303836L141.42857142857144 110.62528635898093L144.28571428571428 109.21459231723539L147.14285714285714 108.41786584414821L150 108.16831683168317L152.85714285714286 108.3924734552377L155.71428571428572 109.01180310974843L158.57142857142858 109.94314519934089L161.42857142857142 111.09870999801029L164.28571428571428 112.38643255922325L167.14285714285714 113.71139405193054L170 114.97880301741924L172.85714285714286 116.09864931737485L175.71428571428572 116.99164703674134L178.57142857142858 117.59559543177377L181.42857142857142 117.87099041920266L184.28571428571428 117.80476524321182L187.14285714285714 117.411453129624L190 116.7317059416742L192.85714285714286 115.8287245178289L195.71428571428572 114.7835333555604L198.57142857142856 113.69006749783063L201.42857142857144 112.6507846697823L204.28571428571428 111.77311195704156L207.14285714285714 111.16663060223823L210 110.94059405940592L212.85714285714286 111.20120667141308L215.71428571428572 112.04807197602412L218.57142857142858 113.56934993909913L221.42857142857142 115.83544210956492L224.28571428571428 118.89144568893397L227.14285714285714 122.74914121235543L230 127.37980200799699L232.85714285714286 132.70946677251928L235.71428571428572 138.6183000959413L238.57142857142858 144.94514145619667L241.42857142857142 151.49734253244677L244.28571428571428 158.0647704623792L247.14285714285714 164.43582223940288L250 170.41283918040318L252.85714285714286 175.82459516497747L255.71428571428572 180.53441923234126L258.57142857142856 184.44364522212675L261.42857142857144 187.49107186523798L264.2857142857143 189.64971550185635L267.14285714285717 190.92228858732287L270 191.33663366336634L272.85714285714283 190.94193722282165L275.7142857142857 189.80607892935723L278.57142857142856 188.01403067552323L281.42857142857144 185.66685777983193L284.2857142857143 182.88062402262045L287.14285714285717 179.78439831387922L290 176.5166447419203L292.85714285714283 173.21957818138446L295.7142857142857 170.03156566080236L298.57142857142856 167.0782519833681L301.42857142857144 164.46361289576248L304.2857142857143 162.26239388434465L307.14285714285717 160.5152492895202L310 159.22737291578525L312.85714285714283 158.37068020403763L315.7142857142857 157.8889138917545L318.57142857142856 157.70461168254386L321.42857142857144 157.7267827360142L324.2857142857143 157.85834033776558L327.14285714285717 158.00269764891317L330 158.06930693069307L332.85714285714283 157.97820438412006L335.7142857142857 157.6637626637648L338.57142857142856 157.07784803449192L341.42857142857144 156.19245646557872L344.2857142857143 155.00170923875672L347.14285714285717 153.52288530050484L350 151.79602811232905L352.85714285714283 149.88166412164927L355.7142857142857 147.85636032989936L358.57142857142856 145.8062258860995L361.42857142857144 143.81894379417128L364.2857142857143 141.97535132903266L367.14285714285717 140.34180530450223L370 138.96446966563698L372.85714285714283 137.86626854497158L375.7142857142857 137.04669509824615L378.57142857142856 136.484141952893L381.42857142857144 136.14007287854776L384.2857142857143 135.9642450130887L387.14285714285717 135.90028088245214L390 135.89108910891088L392.85714285714283 135.88384461838567L395.7142857142857 135.8343914382858L398.57142857142856 135.7109893285718L401.42857142857144 135.4972903001406L404.2857142857143 135.19433207603086L407.14285714285717 134.82122474946624L410 134.41415091228092L412.85714285714283 134.02336453298372L415.7142857142857 133.7081000210976L418.57142857142856 133.5296743624604L421.42857142857144 133.54349313374786L424.2857142857143 133.79101093573504L427.14285714285717 134.29280493674642L430 135.04372836745756L432.85714285714283 136.01067073874802L435.7142857142857 137.1329178270452L438.57142857142856 138.32466124533838L441.42857142857144 139.47898494709463L444.2857142857143 140.47268517541548L447.14285714285717 141.17150156762952L450 141.43564356435644L452.85714285714283 141.12577867096053L455.7142857142857 140.10982077275744L458.57142857142856 138.27085826833132L461.42857142857144 135.516358573243L464.2857142857143 131.78837191209723L467.14285714285717 127.07387517673239L470 121.41376189461978L472.85714285714283 114.9084996530226L475.7142857142857 107.7183991804744L478.57142857142856 100.05698593424617L481.42857142857144 92.17717113436704L484.2857142857143 84.35153437993701L487.14285714285717 76.84954531642079L490 69.91539841262771L492.85714285714283 63.74996678626972L495.7142857142857 58.499264658704035L498.57142857142856 54.250185666205475L501.42857142857144 51.03273717195731L504.2857142857143 48.82696462460139L507.14285714285717 47.57241475288944L510 47.17821782178214L512.8571428571429 47.53243664058325L515.7142857142857 48.50998906104608L518.5714285714286 49.979028962792185L521.4285714285714 51.806080373227026L524.2857142857143 53.86043253154193L527.1428571428571 56.0183217629052L530 58.16726335552785L532.8571428571429 60.21058520683086L535.7142857142857 62.07182261755712L538.5714285714286 63.698276257388386L541.4285714285714 65.06285963579437L544.2857142857143 66.16348732430178L547.1428571428571 67.01969528229046L550 67.66680932671466L552.8571428571429 68.14855339873826L555.7142857142857 68.509294600885L558.5714285714286 68.78706403235475L561.4285714285714 69.00814347279693L564.2857142857143 69.18354610780257L567.1428571428571 69.30732614452188L570 69.35643564356434L572.8571428571429 69.29182441138983L575.7142857142857 69.0606021657049L578.5714285714286 68.59927383966236L581.4285714285714 67.83823485610442L584.2857142857143 66.70778949584782L587.1428571428571 65.14584966313642L590 63.10711720856591L592.8571428571429 60.5729422595352L595.7142857142857 57.560296355680784L598.5714285714286 54.12768396786872L601.4285714285714 50.375742709461846L604.2857142857143 46.44108450851045L607.1428571428571 42.48358796586964L610 38.66933135177587L612.8571428571429 35.152786461475515L615.7142857142857 32.06207209737212L618.5714285714286 29.48992039559819L621.4285714285714 27.49113847028855L624.2857142857143 26.085606350726984L627.1428571428571 25.264841622409854L630 25L633.9285714285714 25.466216660504195L637.8571428571429 26.780161581511198L641.7857142857143 28.816494863870613L645.7142857142857 31.459521976116783L649.6428571428571 34.60582148818114L653.5714285714286 38.16146922589543L657.5 42.03634650305975L661.4285714285714 46.13759227609798L665.3571428571429 50.36405551668713L669.2857142857143 54.60352919261186L673.2142857142857 58.73429421211376L677.1428571428571 62.63172620642737L681.0714285714286 66.17929717029618L685 69.28158864938563L688.9285714285714 71.87573603466166L692.8571428571429 73.9378600764504L696.7857142857143 75.48266683279434L700.7142857142857 76.55674796777382L704.6428571428571 77.22799920822796L708.5714285714286 77.57420689943201L712.5 77.67326732673266L712.5 305"></path><path fill="none" stroke="#fe7a81" stroke-width="2.5" d="M7.5 133.11881188118812L11.428571428571429 133.21109516764975L15.357142857142858 133.52778852939568L19.285714285714285 134.1314924900395L23.214285714285715 135.0837870296291L27.142857142857142 136.43748279898327L31.071428571428573 138.22780684124353L35 140.46449573435964L38.92857142857143 143.12714230960736L42.857142857142854 146.1655461006189L46.785714285714285 149.50527294863713L50.714285714285715 153.05679244559755L54.642857142857146 156.7253617973526L58.57142857142857 160.4188118536953L62.5 164.05138836204313L66.42857142857143 167.54314382997958L70.35714285714286 170.81544134857938L74.28571428571429 173.7836904372982L78.21428571428571 176.3486401278634L82.14285714285714 178.38774414968665L86.07142857142857 179.74861152637322L90 180.24752475247524L92.85714285714286 179.95103668058198L95.71428571428571 179.00734090551404L98.57142857142857 177.34149627121693L101.42857142857143 174.89571161164582L104.28571428571429 171.64157157741596L107.14285714285714 167.59236206870298L110 162.81273625474049L112.85714285714286 157.42256486025417L115.71428571428572 151.5924833401362L118.57142857142857 145.53052884736644L121.42857142857143 139.46183945243214L124.28571428571428 133.60559866695854L127.14285714285714 128.15420054550972L130 123.25862814912055L132.85714285714286 119.02183949833571L135.71428571428572 115.49960403088909L138.57142857142856 112.70662898303836L141.42857142857144 110.62528635898093L144.28571428571428 109.21459231723539L147.14285714285714 108.41786584414821L150 108.16831683168317L152.85714285714286 108.3924734552377L155.71428571428572 109.01180310974843L158.57142857142858 109.94314519934089L161.42857142857142 111.09870999801029L164.28571428571428 112.38643255922325L167.14285714285714 113.71139405193054L170 114.97880301741924L172.85714285714286 116.09864931737485L175.71428571428572 116.99164703674134L178.57142857142858 117.59559543177377L181.42857142857142 117.87099041920266L184.28571428571428 117.80476524321182L187.14285714285714 117.411453129624L190 116.7317059416742L192.85714285714286 115.8287245178289L195.71428571428572 114.7835333555604L198.57142857142856 113.69006749783063L201.42857142857144 112.6507846697823L204.28571428571428 111.77311195704156L207.14285714285714 111.16663060223823L210 110.94059405940592L212.85714285714286 111.20120667141308L215.71428571428572 112.04807197602412L218.57142857142858 113.56934993909913L221.42857142857142 115.83544210956492L224.28571428571428 118.89144568893397L227.14285714285714 122.74914121235543L230 127.37980200799699L232.85714285714286 132.70946677251928L235.71428571428572 138.6183000959413L238.57142857142858 144.94514145619667L241.42857142857142 151.49734253244677L244.28571428571428 158.0647704623792L247.14285714285714 164.43582223940288L250 170.41283918040318L252.85714285714286 175.82459516497747L255.71428571428572 180.53441923234126L258.57142857142856 184.44364522212675L261.42857142857144 187.49107186523798L264.2857142857143 189.64971550185635L267.14285714285717 190.92228858732287L270 191.33663366336634L272.85714285714283 190.94193722282165L275.7142857142857 189.80607892935723L278.57142857142856 188.01403067552323L281.42857142857144 185.66685777983193L284.2857142857143 182.88062402262045L287.14285714285717 179.78439831387922L290 176.5166447419203L292.85714285714283 173.21957818138446L295.7142857142857 170.03156566080236L298.57142857142856 167.0782519833681L301.42857142857144 164.46361289576248L304.2857142857143 162.26239388434465L307.14285714285717 160.5152492895202L310 159.22737291578525L312.85714285714283 158.37068020403763L315.7142857142857 157.8889138917545L318.57142857142856 157.70461168254386L321.42857142857144 157.7267827360142L324.2857142857143 157.85834033776558L327.14285714285717 158.00269764891317L330 158.06930693069307L332.85714285714283 157.97820438412006L335.7142857142857 157.6637626637648L338.57142857142856 157.07784803449192L341.42857142857144 156.19245646557872L344.2857142857143 155.00170923875672L347.14285714285717 153.52288530050484L350 151.79602811232905L352.85714285714283 149.88166412164927L355.7142857142857 147.85636032989936L358.57142857142856 145.8062258860995L361.42857142857144 143.81894379417128L364.2857142857143 141.97535132903266L367.14285714285717 140.34180530450223L370 138.96446966563698L372.85714285714283 137.86626854497158L375.7142857142857 137.04669509824615L378.57142857142856 136.484141952893L381.42857142857144 136.14007287854776L384.2857142857143 135.9642450130887L387.14285714285717 135.90028088245214L390 135.89108910891088L392.85714285714283 135.88384461838567L395.7142857142857 135.8343914382858L398.57142857142856 135.7109893285718L401.42857142857144 135.4972903001406L404.2857142857143 135.19433207603086L407.14285714285717 134.82122474946624L410 134.41415091228092L412.85714285714283 134.02336453298372L415.7142857142857 133.7081000210976L418.57142857142856 133.5296743624604L421.42857142857144 133.54349313374786L424.2857142857143 133.79101093573504L427.14285714285717 134.29280493674642L430 135.04372836745756L432.85714285714283 136.01067073874802L435.7142857142857 137.1329178270452L438.57142857142856 138.32466124533838L441.42857142857144 139.47898494709463L444.2857142857143 140.47268517541548L447.14285714285717 141.17150156762952L450 141.43564356435644L452.85714285714283 141.12577867096053L455.7142857142857 140.10982077275744L458.57142857142856 138.27085826833132L461.42857142857144 135.516358573243L464.2857142857143 131.78837191209723L467.14285714285717 127.07387517673239L470 121.41376189461978L472.85714285714283 114.9084996530226L475.7142857142857 107.7183991804744L478.57142857142856 100.05698593424617L481.42857142857144 92.17717113436704L484.2857142857143 84.35153437993701L487.14285714285717 76.84954531642079L490 69.91539841262771L492.85714285714283 63.74996678626972L495.7142857142857 58.499264658704035L498.57142857142856 54.250185666205475L501.42857142857144 51.03273717195731L504.2857142857143 48.82696462460139L507.14285714285717 47.57241475288944L510 47.17821782178214L512.8571428571429 47.53243664058325L515.7142857142857 48.50998906104608L518.5714285714286 49.979028962792185L521.4285714285714 51.806080373227026L524.2857142857143 53.86043253154193L527.1428571428571 56.0183217629052L530 58.16726335552785L532.8571428571429 60.21058520683086L535.7142857142857 62.07182261755712L538.5714285714286 63.698276257388386L541.4285714285714 65.06285963579437L544.2857142857143 66.16348732430178L547.1428571428571 67.01969528229046L550 67.66680932671466L552.8571428571429 68.14855339873826L555.7142857142857 68.509294600885L558.5714285714286 68.78706403235475L561.4285714285714 69.00814347279693L564.2857142857143 69.18354610780257L567.1428571428571 69.30732614452188L570 69.35643564356434L572.8571428571429 69.29182441138983L575.7142857142857 69.0606021657049L578.5714285714286 68.59927383966236L581.4285714285714 67.83823485610442L584.2857142857143 66.70778949584782L587.1428571428571 65.14584966313642L590 63.10711720856591L592.8571428571429 60.5729422595352L595.7142857142857 57.560296355680784L598.5714285714286 54.12768396786872L601.4285714285714 50.375742709461846L604.2857142857143 46.44108450851045L607.1428571428571 42.48358796586964L610 38.66933135177587L612.8571428571429 35.152786461475515L615.7142857142857 32.06207209737212L618.5714285714286 29.48992039559819L621.4285714285714 27.49113847028855L624.2857142857143 26.085606350726984L627.1428571428571 25.264841622409854L630 25L633.9285714285714 25.466216660504195L637.8571428571429 26.780161581511198L641.7857142857143 28.816494863870613L645.7142857142857 31.459521976116783L649.6428571428571 34.60582148818114L653.5714285714286 38.16146922589543L657.5 42.03634650305975L661.4285714285714 46.13759227609798L665.3571428571429 50.36405551668713L669.2857142857143 54.60352919261186L673.2142857142857 58.73429421211376L677.1428571428571 62.63172620642737L681.0714285714286 66.17929717029618L685 69.28158864938563L688.9285714285714 71.87573603466166L692.8571428571429 73.9378600764504L696.7857142857143 75.48266683279434L700.7142857142857 76.55674796777382L704.6428571428571 77.22799920822796L708.5714285714286 77.57420689943201L712.5 77.67326732673266"></path><text x="7.5" y="127.11881188118812" dominant-baseline="text-after-edge" text-anchor="start" fill="#fe7a81" font-size="11">6.2</text><text x="30" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">январь</text><text x="30" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="7.5" cy="133.11881188118812" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="90" y="174.24752475247524" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.5</text><text x="90" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">февраль</text><text x="90" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="90" cy="180.24752475247524" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="150" y="102.16831683168317" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7.1</text><text x="150" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">март</text><text x="150" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="150" cy="108.16831683168317" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="210" y="104.94059405940592" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">7</text><text x="210" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">апрель</text><text x="210" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="210" cy="110.94059405940592" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="270" y="185.33663366336634" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">4.1</text><text x="270" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">май</text><text x="270" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="270" cy="191.33663366336634" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="330" y="152.06930693069307" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.3</text><text x="330" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июнь</text><text x="330" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="330" cy="158.06930693069307" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="390" y="129.89108910891088" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">6.1</text><text x="390" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">июль</text><text x="390" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="390" cy="135.89108910891088" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="450" y="135.43564356435644" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">5.9</text><text x="450" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">август</text><text x="450" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="450" cy="141.43564356435644" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="510" y="41.17821782178214" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">9.3</text><text x="510" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">сентябрь</text><text x="510" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="510" cy="47.17821782178214" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="570" y="63.35643564356434" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">8.5</text><text x="570" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">октябрь</text><text x="570" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="570" cy="69.35643564356434" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="630" y="19" dominant-baseline="text-after-edge" text-anchor="middle" fill="#fe7a81" font-size="11">10.1</text><text x="630" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">ноябрь</text><text x="630" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="630" cy="25" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle><text x="712.5" y="71.67326732673266" dominant-baseline="text-after-edge" text-anchor="end" fill="#fe7a81" font-size="11">8.2</text><text x="690" y="305" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">декабрь</text><text x="690" y="316" dominant-baseline="text-before-edge" text-anchor="middle" fill="#888" font-size="10">2024</text><circle cx="712.5" cy="77.67326732673266" r="5" fill="#ffffff" stroke="#fe7a81" stroke-width="2.5"></circle></svg>
</div>

<h2>Итого</h2>

<p>В данной статье мы шаг за шагом реализовали линейную диаграмму с использованием чистого JavaScript и SVG. Мы подробно рассмотрели процесс создания диаграммы, начиная с построения линий и добавления подписей, до реализации маркеров и добавления сглаживания кривых для улучшения визуального восприятия:</p>

<ul>
    <li><b class="highlight">Построение линии и области</b>: используя элемент <code>path</code> и команды <code>M</code> и <code>L</code>, мы научились рисовать как основную линию, так и дополнительные области, создавая полноценную диаграмму.</li>
    <li><b class="highlight">Подписи и маркеры</b>: мы добавили текстовые подписи и маркеры для точек на диаграмме, что значительно повысило информативность и удобство восприятия.</li>
    <li><b class="highlight">Сглаживание</b>: сглаживание кривых с помощью метода обратных взвешенных расстояний позволило сделать диаграмму более плавной и визуально приятной.</li>
</ul>

<p>В итоге, всего за 150 строк кода (30 из которых просто сохранение конфигурации) мы создали динамическую и настраиваемую линейную диаграмму, которая может быть легко адаптирована под разные нужды, а её внешний вид и функциональность значительно улучшены за счёт нескольких небольших, но важных изменений.</p>

<div class="code">
    <div class="code-title">Итоговый файл <a class="link" download href="/media/articles/{{article.link}}/linear_chart.html">linear_chart.html</a></div>
<pre data-lang="html">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;title&gt;Линейная диаграмма&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;svg id="linear-chart"&gt;&lt;/svg&gt;

    &lt;script src="linear_chart.js"&gt;&lt;/script&gt;
    &lt;script&gt;
        const config = {
            svg: document.getElementById("linear-chart"),
            padding: {bottom: 25, top: 25},
            line: {
                color: "#fe7a81",
                background: "#ffddd7"
            },
            marker: {
                radius: 5,
                color: "#fe7a81",
                background: "#ffffff",
                width: 60,
                height: 280
            },
            value: {size: 11, color: "#fe7a81"},
            label: {size: 10, color: "#888"}
        }

        const data = [
            {value: 6.2, label: "январь\n2024"},
            {value: 4.5, label: "февраль\n2024"},
            {value: 7.1, label: "март\n2024"},
            {value: 7, label: "апрель\n2024"},
            {value: 4.1, label: "май\n2024"},
            {value: 5.3, label: "июнь\n2024"},
            {value: 6.1, label: "июль\n2024"},
            {value: 5.9, label: "август\n2024"},
            {value: 9.3, label: "сентябрь\n2024"},
            {value: 8.5, label: "октябрь\n2024"},
            {value: 10.1, label: "ноябрь\n2024"},
            {value: 8.2, label: "декабрь\n2024"}
        ]

        const linearChart = new LinearChart(config)
        linearChart.plot(data)
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<div class="code">
    <div class="code-title">Итоговый файл <a class="link" download href="/media/articles/{{article.link}}/linear_chart.js">linear_chart.js</a></div>
<pre data-lang="js">
class LinearChart {
    constructor(config) {
        this.svg = config.svg
        this.padding = {
            top: config.padding?.top ?? 15,
            bottom: config.padding?.bottom ?? 25
        }

        this.line = {
            color: config.line?.color ?? "#9cc2ff",
            background: config.line?.background ?? "#ecf4ff"
        }

        this.marker = {
            radius: config.marker?.radius ?? 5,
            color: config.marker?.color ?? "#9cc2ff",
            background: config.marker?.background ?? "#ffffff",
            width: config.marker?.width ?? 50,
            height: config.marker?.height ?? 300
        }

        this.value = {
            size: config.value.size ?? 10,
            color: config.value.color ?? "#888"
        }

        this.label = {
            size: config.label.size ?? 10,
            color: config.label.color ?? "#888"
        }
    }

    plot(data) {
        const width = data.length * this.marker.width
        const height = this.padding.top + this.marker.height + this.padding.bottom

        this.svg.style.width = `${width}px`
        this.svg.style.height = `${height}px`

        const values = data.map(item => item.value)
        const min = Math.min(...values, 0)
        const max = Math.max(...values, 0)

        const points = []
        const paths = this.addPaths(points, this.map(0, min, max, height - this.padding.bottom, this.padding.top))

        for (let i = 0; i < data.length; i++) {
            const x = this.map(i, 0, data.length - 1, this.marker.width / 2, width - this.marker.width / 2)
            const y = this.map(data[i].value, min, max, height - this.padding.bottom, this.padding.top)
            const offset = (this.marker.width / 2 - this.marker.radius * 1.5) * (i == 0 ? -1 : i == data.length - 1 ? 1 : 0)
            const anchor = i == 0 ? "start" : i == data.length - 1 ? "end" : "middle"

            this.addLabel(x + offset, y - this.marker.radius - 1, `${data[i].value}`, this.value, anchor, "text-after-edge")
            this.addLabel(x, height - this.padding.bottom, data[i].label, this.label, "middle", "text-before-edge")
            this.addMarker(x + offset, y)

            points.push({x: x + offset, y: y})
        }

        this.updatePaths(paths, points, min, max, height)
    }

    map(x, xmin, xmax, min, max) {
        return (x - xmin) * (max - min) / (xmax - xmin) + min
    }

    addLabel(x, y, text, format, anchor, baseline) {
        for (const line of text.split("\n")) {
            const label = document.createElementNS("http://www.w3.org/2000/svg", "text")

            label.textContent = line
            label.setAttribute("x", x)
            label.setAttribute("y", y)
            label.setAttribute("dominant-baseline", baseline)
            label.setAttribute("text-anchor", anchor)
            label.setAttribute("fill", format.color)
            label.setAttribute("font-size", format.size)

            this.svg.appendChild(label)

            y += label.getBBox().height
        }
    }

    addPaths() {
        const area = document.createElementNS("http://www.w3.org/2000/svg", "path")
        area.setAttribute("fill", this.line.background)

        const line = document.createElementNS("http://www.w3.org/2000/svg", "path")
        line.setAttribute("fill", "none")
        line.setAttribute("stroke", this.line.color)
        line.setAttribute("stroke-width", this.marker.radius / 2)

        this.svg.appendChild(area)
        this.svg.appendChild(line)
        return {area, line}
    }

    addMarker(x, y) {
        const marker = document.createElementNS("http://www.w3.org/2000/svg", "circle")
        marker.setAttribute("cx", x)
        marker.setAttribute("cy", y)
        marker.setAttribute("r", this.marker.radius)
        marker.setAttribute("fill", this.marker.background)
        marker.setAttribute("stroke", this.marker.color)
        marker.setAttribute("stroke-width", this.marker.radius / 2)

        this.svg.appendChild(marker)
    }

    points2path(points) {
        return points.map((point, i) => `${i == 0 ? "M" : "L"}${point.x} ${point.y}`).join("")
    }

    interpolate(x, points) {
        let result = 0
        let sum = 0

        for (let i = 0; i < points.length; i++) {
            const distance = Math.abs(x - points[i].x)

            if (distance === 0)
                return {x: x, y: points[i].y}

            const weight = 1 / Math.pow(distance, 2)
            result += points[i].y * weight
            sum += weight
        }

        return {x: x, y: result / sum}
    }

    smoothPoints(points, smoothCount = 20) {
        const smoothedPoints = [points[0]]

        for (let i = 1; i < points.length; i++) {
            for (let j = 0; j < smoothCount; j++)
                smoothedPoints.push(this.interpolate(this.map(j, -1, smoothCount, points[i - 1].x, points[i].x), points))

            smoothedPoints.push(points[i])
        }

        return smoothedPoints
    }

    updatePaths(paths, points, min, max, height) {
        const y0 = this.map(0, min, max, height - this.padding.bottom, this.padding.top)
        const smoothedPoints = this.smoothPoints(points)

        paths.line.setAttribute("d", this.points2path(smoothedPoints))
        paths.area.setAttribute("d", this.points2path([{x: points[0].x, y: y0}, ...smoothedPoints, {x: points[points.length - 1].x, y: y0}]))
    }
}
</pre>
</div>